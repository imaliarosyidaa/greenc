import{_ as D,j as i,I as j,M as R,k as V,ag as q,c as g,a,t,Q as A,f as N,ah as O,R as T,S as L,e as E,h as B,o as y}from"./index-CzogK9Kh.js";const F={class:"bg-white -z-10 absolute"},G={class:"mx-auto max-w-2xl px-4 pt-10 pb-16 sm:px-6 lg:max-w-7xl lg:grid-cols-3 lg:px-8 lg:pt-16 lg:pb-24"},H={class:"max-w-7xl mx-auto p-6 grid grid-cols-1 md:grid-cols-2 gap-24"},Q={class:"mt-6"},$={class:"text-gray-600 font-medium"},z={class:"mt-4 flex justify-between items-center"},J={class:"text-lg font-semibold"},K={class:"text-lg font-semibold"},U={class:"mt-4 flex justify-between items-center"},Y={class:"text-lg font-semibold"},W={class:"mt-6"},X=["value"],Z={class:"bg-white shadow-md rounded-lg p-4 self-start"},ee={class:"flex justify-between mt-2"},ae={class:"flex justify-between mt-4 font-bold text-lg"},te={key:0,class:"text-red-500 mt-2"},se=["disabled"],b=1e3,h=2500,le={__name:"CheckoutView",props:{user:Object},setup(m){const x=q(),M=m,n=i(),_=i(!1),o=i(""),c=R(),S=async()=>{var l,e;_.value=!0,o.value="";try{const s=await B.get(`/products/${c.params.id}`);n.value=s.data,console.log(n)}catch(s){o.value=((e=(l=s.response)==null?void 0:l.data)==null?void 0:e.message)||"Gagal mengambil data produk"}finally{_.value=!1}},v=i(0),d=i(0);j(S);const f=c.query.q||1;V(()=>{var e,s;const l=parseInt((e=n==null?void 0:n.value)==null?void 0:e.price.replace(/\./g,""));d.value=l*f,(s=n.value)!=null&&s.price&&(v.value=h+b+d.value)});const C=[{name:"Bank BRI",val:"bank_bri",href:"#"},{name:"Bank Seabank",val:"bank_seabank",href:"#"},{name:"DANA",val:"dana",href:"#"},{name:"GOPAY",val:"gopay",href:"#"},{name:"OVO",val:"ovo",href:"#"},{name:"Shopeepay",val:"shopeepay",href:"#"},{name:"SCAN QRIS (Semua Pembayaran)",val:"qris",href:"#"}];j(()=>{localStorage.getItem("userInfo")||x.push("/signin")});const u=i(""),p=i(!1),I=async()=>{if(!u.value){o.value="Pilih metode pembayaran terlebih dahulu!";return}p.value=!0,o.value="";const l=Math.floor(Math.random()*500)+1,e=new FormData;e.append("id",l),e.append("user_id",M.user.id),e.append("product_id",c.params.id),e.append("payment_method",u.value),e.append("total_price",d.value),e.append("total_bill",v.value),e.append("biaya_layanan",b),e.append("biaya_aplikasi",h),e.append("quantity",f);try{await B.post("/payment",e,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!1}),x.push(`/payment/${l}`)}catch(s){o.value="Pembayaran gagal! Coba lagi.",console.error(s)}finally{p.value=!1}};return(l,e)=>{var s,w,k,P;return y(),g("div",F,[a("div",G,[a("div",H,[a("div",null,[a("div",Q,[e[1]||(e[1]=a("h3",{class:"text-lg font-semibold text-gray-700"},"Detail Pemesan",-1)),a("p",$,t((s=m.user)==null?void 0:s.name)+" - "+t((w=m.user)==null?void 0:w.email),1)]),a("div",z,[a("p",J,t((k=n.value)==null?void 0:k.name),1),a("p",K,t((P=n.value)==null?void 0:P.price),1)]),a("div",U,[e[2]||(e[2]=a("h3",{class:"text-lg font-semibold text-gray-700"},"Kuantitas",-1)),a("p",Y,t(A(f)),1)]),a("div",W,[e[4]||(e[4]=a("h3",{class:"text-lg font-semibold text-gray-700"},"Pilih Pembayaran",-1)),N(a("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>u.value=r),class:"border p-2 rounded w-full mt-2"},[e[3]||(e[3]=a("option",{disabled:"",selected:"",value:""},"Pilih Metode Pembayaran",-1)),(y(),g(T,null,L(C,r=>a("option",{key:r.val,value:r.val},t(r.name),9,X)),64))],512),[[O,u.value]])])]),a("div",Z,[e[9]||(e[9]=a("h3",{class:"text-lg font-semibold"},"Ringkasan Pemesanan",-1)),a("div",ee,[e[5]||(e[5]=a("span",null,"Total Harga",-1)),a("span",null,t(d.value),1)]),a("div",{class:"flex justify-between mt-2"},[e[6]||(e[6]=a("span",null,"Biaya Layanan",-1)),a("span",null,t(b))]),a("div",{class:"flex justify-between mt-2"},[e[7]||(e[7]=a("span",null,"Biaya Jasa Aplikasi",-1)),a("span",null,t(h))]),a("div",ae,[e[8]||(e[8]=a("span",null,"Total Tagihan",-1)),a("span",null,t(v.value),1)]),o.value?(y(),g("p",te,t(o.value),1)):E("",!0),a("button",{onClick:I,disabled:p.value,class:"mt-6 w-full bg-yellow-500 cursor-pointer text-white py-3 rounded-lg flex justify-center items-center"},t(p.value?"Memproses...":"Bayar â†’"),9,se)])])])])}}},oe=D(le,[["__scopeId","data-v-bdc651d7"]]);export{oe as default};
